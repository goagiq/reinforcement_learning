model:
  algorithm: PPO
  learning_rate: 0.0001
  batch_size: 128
  n_steps: 4096
  n_epochs: 30
  gamma: 0.99
  gae_lambda: 0.95
  clip_range: 0.2
  value_loss_coef: 0.5
  entropy_coef: 0.05
  max_grad_norm: 0.5
  use_enhanced_architecture: false
  architecture_variant: standard
  hidden_dims:
  - 256
  - 256
  - 128
  shared_hidden_dims:
  - 128
  - 64
  walk_forward_validation:
    enabled: false
    train_window: 252
    test_window: 63
    step_size: 21
    window_type: rolling
    run_after_training: false
unsupervised_pretraining:
  enabled: true
  latent_dim: 128
  use_sequence: true
  sequence_length: 20
  strategy_compliant_weight: 3.0
  strategy_partial_weight: 1.0
  strategy_non_compliant_weight: 0.5
  vae_hidden_dims:
  - 256
  - 256
  sequence_hidden_dim: 128
  sequence_num_layers: 2
  batch_size: 256
  epochs: 20
  learning_rate: 0.001
  validation_split: 0.2
  combine_method: concat

pretraining:
  enabled: true
  lookahead_bars: 20
  return_threshold: 0.02
  batch_size: 256
  epochs: 10
  learning_rate: 0.001
  validation_split: 0.2
  labeling_strategy: simple_return
  save_pretrained_weights: false
  strategy_aware_labeling: false
  use_numba: true
  use_memory_mapping: true
  memory_map_threshold_mb: 500
environment:
  instrument: ES
  timeframes:
  - 1
  - 5
  - 15
  state_features: 916  # 900 base + 5 regime + 3 forecast + 8 strategy features
  action_space: continuous
  action_range:
  - -1.0
  - 1.0
  action_threshold: 0.05
  max_episode_steps: 10000
  lookback_bars: 20
  trading_hours:
    enabled: true
    source_timezone: America/New_York
    exclude_weekends: true
    use_nt8_calendar: true
    sessions:
    - name: Tokyo
      timezone: Asia/Tokyo
      start: 09:00
      end: '15:00'
    - name: London
      timezone: Europe/London
      start: 08:00
      end: '16:30'
    - name: New York
      timezone: America/New_York
      start: 09:30
      end: '16:00'
  reward:
    pnl_weight: 1.0
    transaction_cost: 5.0e-05
    risk_penalty: 0.05
    drawdown_penalty: 0.07
    feature_normalization:
      enabled: true
      method: standard
      strategy_normalization: minmax
    exploration_bonus_enabled: true
    exploration_bonus_scale: 1.0e-05
    action_diversity_bonus: 0.0
    constant_action_penalty: 0.0
    loss_mitigation: 0.0
    overtrading_penalty_enabled: false
    optimal_trades_per_episode: null
    profit_factor_required: 1.0
    inaction_penalty: 0.0001
    max_consecutive_losses: 5
    resume_confluence_required: 3
    stop_loss_pct: 0.025
    min_risk_reward_ratio: 2.0
    trailing_stop:
      enabled: true
      atr_multiplier: 2.0
      pct_fallback: 0.02
      min_distance_pct: 0.005
      max_distance_pct: 0.05
      activation_pct: 0.025
    take_profit:
      enabled: true
      mode: soft_targets
      risk_reward_ratio: 1.5
      pct_fallback: 0.05
      bonus_multiplier: 1.5
    include_regime_features: true
    include_forecast_features: true
    forecast_horizon: 5
    forecast_cache_steps: 20
    quality_filters:
      enabled: true
      min_action_confidence: 0.2
      min_quality_score: 0.4
      require_positive_expected_value: false
    bid_ask_spread:
      enabled: true
      spread_pct: 0.0005
    volatility_position_sizing:
      enabled: true
      risk_per_trade_pct: 0.01
      atr_period: 14
      atr_multiplier: 2.0
      min_position_size: 0.01
      max_position_size: 1.0
    slippage:
      enabled: false
      base_slippage: 0.00015
      impact_coefficient: 0.0002
      vol_multiplier: 0.0001
      time_multipliers:
        market_open: 1.5
        market_close: 1.5
        normal_hours: 1.0
        after_hours: 2.0
    market_impact:
      enabled: false
      impact_coefficient: 0.3
      vol_multiplier: 1.0
    strategy_validator:
      enabled: true
      enforcement_level: learning
  portfolio:
    enabled: false
    instruments:
    - ES
    - NQ
    - RTY
    - YM
    max_portfolio_risk: 0.2
    correlation_window: 60
    diversification_target: 0.3
  order_types:
    enabled: false
    default_order_type: market
    fill_probability_limit: 0.8
    max_order_age_seconds: 3600
  transaction_costs:
    enabled: true
    commission_rate: 0.0003
    spread_bps: 0.5
    use_slippage_model: true
    use_market_impact: true
  performance_attribution:
    enabled: false
    track_time_of_day: true
    track_regime: false
  order_book:
    enabled: false
    num_levels: 10
    base_depth: 100.0
    depth_volatility: 0.3
    spread_bps: 0.5
  partial_fills:
    enabled: false
    base_fill_probability: 0.95
    volume_impact_factor: 0.5
    time_decay_factor: 0.1
  latency:
    enabled: false
    base_network_latency: 0.001
    network_latency_std: 0.0005
    processing_latency: 0.0005
    exchange_latency: 0.002
    market_data_latency: 0.001
  regime_strategies:
    enabled: false
    auto_detect_regime: true
    use_regime_position_sizing: true
    use_regime_thresholds: true
  features:
    include_forecast_features: false
training:
  total_timesteps: 20000000
  save_freq: 10000                   # Save checkpoint frequency (regular checkpoints)
  quick_save_freq: 1000              # Quick checkpoint every 1k steps (for faster recovery from failures)
  use_decision_gate: false
  eval_freq: 10000
  device: "cuda"
  num_envs: 1
  transfer_learning: false
  adaptive_training:
    enabled: true
    eval_frequency: 5000
    eval_episodes: 10
    min_trades_per_episode: 0.3
    min_win_rate: 0.4
    target_sharpe: 0.5
    auto_save_on_improvement: true
    improvement_threshold: 0.05
    quality_adjustment_rate: 0.05
    rr_adjustment_rate: 0.2
    pause_on_critical_failure: true
    critical_win_rate_threshold: 0.3
    critical_failure_count: 3
    reward_good_performance: true
    good_win_rate_threshold: 0.5
    good_performance_count: 2
    
    # Enhanced Adaptive Learning (Phase 1, 2, 3)
    # Set to true to enable all enhanced features
    use_enhanced_adaptive_learning: true  # Set to true to enable
    
    # Phase 1: Foundation
    save_effectiveness_to_file: true       # Always saves if enhanced learning enabled
    trend_analysis_enabled: true          # Early warning for declining performance
    oscillation_detection_enabled: true   # Prevent rapid parameter changes
    trend_window_size: 5                   # Snapshots for trend analysis
    oscillation_threshold: 3               # Direction changes to detect oscillation
    
    # Phase 2: Intelligence
    pattern_recognition_enabled: true     # Learn from similar past situations
    effectiveness_optimization_enabled: true  # Use optimal adjustment magnitudes
    correlation_prioritization_enabled: true  # Focus on most impactful adjustments
    pattern_similarity_threshold: 0.7      # Minimum similarity (0-1) to match patterns
    min_pattern_samples: 3                 # Minimum patterns to learn from
    
    # Phase 3: Meta-Learning
    meta_learning_enabled: true           # Learn how to learn better
    strategy_performance_tracking_enabled: true  # Track which strategies work best
    optimal_timing_learning_enabled: true # Learn optimal timing for adjustments
    magnitude_optimization_enabled: true  # Enhanced magnitude optimization
    meta_learning_window: 20               # Adjustments to analyze for meta-learning
    strategy_compliance_weight: 0.2        # Weight for compliance in meta-learning (20%)
  train_split: 0.8
  validation_split: 0.1
  early_stopping:
    enabled: false
    patience: 50000
    min_delta: 0.005
risk_management:
  max_position_size: 1.0
  max_drawdown: 0.2
  max_daily_loss: 0.05
  stop_loss_atr_multiplier: 2.0
  initial_capital: 100000.0
  commission: 2.0
  max_position_fraction_of_balance: 0.02
  position_value_per_unit: 5000.0
  break_even:
    enabled: true
    activation_pct: 0.006
    trail_pct: 0.0015
    scale_out_fraction: 0.5
    scale_out_min_confluence: 2
    free_trade_fraction: 0.5
drift_detection:
  enabled: true
  baseline_metrics:
    win_rate: 0.55
    sharpe_ratio: 1.0
    profit_factor: 1.5
    max_drawdown: 0.15
  thresholds:
    win_rate_drop: 0.1
    sharpe_drop: 0.3
    profit_factor_drop: 0.3
    max_drawdown_increase: 0.05
    consecutive_losses: 5
  window_size: 50
  min_trades: 20
reasoning:
  enabled: true
  provider: ollama
  model: deepseek-r1:8b
  api_key: null
  base_url: null
  keep_alive: 10m
  pre_trade_validation: true
  confidence_threshold: 0.7
  timeout: 2.0
  use_kong: false
  kong_base_url: http://localhost:8300
  kong_api_key: null
agentic_swarm:
  enabled: true
  provider: ollama
  keep_alive: 10m
  max_handoffs: 10
  max_iterations: 15
  execution_timeout: 20.0
  node_timeout: 5.0
  cache_ttl: 300
  contrarian:
    enabled: true
    greed_threshold_percentile: 90
    fear_threshold_percentile: 10
  market_research:
    instruments:
    - ES
    - NQ
    - RTY
    - YM
    correlation_window: 20
    divergence_threshold: 0.1
  sentiment:
    sources:
    - newsapi
    newsapi_key: null
    sentiment_window: 3600
  elliott_wave:
    enabled: true
    lookback_bars: 400
    swing_threshold: 0.003
    min_confidence: 0.55
    position_multiplier: 0.6
    max_position_size: 0.8
    min_bars: 120
  analyst:
    deep_reasoning: true
    conflict_detection: true
  recommendation:
    risk_integration: true
    position_sizing: true
decision_gate:
  rl_weight: 0.6
  swarm_weight: 0.4
  min_combined_confidence: 0.6
  conflict_reduction_factor: 0.5
  min_confluence_required: 2
  swarm_enabled: true
  swarm_timeout: 20.0
  fallback_to_rl_only: true
  quality_scorer:
    enabled: true
    min_quality_score: 0.7
    min_risk_reward_ratio: 2.0
    min_profit_margin: 1.5
    min_volatility: 0.01
    min_volume_ratio: 1.2
    confidence_weight: 0.3
    confluence_weight: 0.2
    expected_profit_weight: 0.2
    risk_reward_weight: 0.15
    market_conditions_weight: 0.15
  position_sizing:
    enabled: true
    scale_multipliers:
      '1': 1.0
      '2': 1.15
      '3': 1.3
    max_scale: 1.3
    min_scale: 0.3
    hold_scale: 0.3
    rl_only_scale: 0.5
    swarm_only_scale: 0.65
    disagreement_scale: 0.35
    contrarian_threshold: 0.6
    elliott_threshold: 0.6
manual_approval:
  enabled: false
  auto_approve_timeout: 30.0
  require_approval_for:
  - high_risk_trades
  - conflicting_signals
  - large_position_sizes
logging:
  log_dir: logs
  tensorboard: true
  verbose: 1
live_trading:
  enabled: false
  paper_trading: true
bridge:
  host: localhost
  port: 8888
continuous_learning:
  retrain_frequency: 1000
  min_experiences: 500
  evaluation_episodes: 10
  min_annotated_for_finetune: 100
  experience_buffer_size: 10000
  experience_storage: data/experience_buffer
